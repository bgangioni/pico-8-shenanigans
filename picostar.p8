pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
  --additional colors
  poke( 0x5f2e, 1 )
  
  pal( {[0]=0,8,137,9,10,135,6,7,0,9,10,11,12,13,14,15} ,1 )
--  pal( {[0]=0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15} ,1 )

  px = 64
  py = 64

		bx = nil
		by = nil
		bframe = nil
		
		rx = nil
		ry = nil  

  starspeed = 1
  countstars = 50
  starfield = {}
  for i  = 1 , countstars do
    starfield[i] = {}
    starfield[i].x = flr(rnd(128))
    starfield[i].y = flr(rnd(128))
    starfield[i].z = flr(rnd(4))
  end
end

function _update()
  if btnp(ğŸ…¾ï¸) then
    --pal( {[0]=0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15} ,1 )
    if not rx then
      rx = {}
      rx[1] = px+flr(rnd(5))-2
      rx[2] = px
      rx[3] = px-flr(rnd(5))+2
      rx[4] = py-flr(rnd(3))
      rx[5] = py
      rx[6] = py+flr(rnd(3))
    end
  end
  
  if btnp(â) then
    if not bx then
      bx = px
      by = py
    end
  end
  
  if btn(â¬†ï¸) and py >   4 then py -=1 end
  if btn(â¬‡ï¸) and py < 116 then py +=1 end
  if btn(â¡ï¸) and px < 116 then px +=1 end
  if btn(â¬…ï¸) and px >   4 then px -=1 end
  
  if bframe == 0 then bframe = nil end
  if bframe then bframe -=1 end
  if bx then
    bx += (2+flr(bx/16))
    if bx > 129 then bx = nil bframe = 7 end
  end
  
  if rx then
    local rxspeed = (2+flr(rx[1]/16))
    rx[1] += rxspeed 
    rx[2] += rxspeed 
    rx[3] += rxspeed 
    if rx[1] > 129 then rx = nil end
  end
  
  for i = 1, countstars do
    starfield[i].x -= flr(starspeed*starfield[i].z)
    if starfield[i].x < 0 then starfield[i].x = 129 starfield[i].y = flr(rnd(129)) end
  end
  
end

function _draw()
  cls()
  for i = 1, countstars do
    pset(starfield[i].x,starfield[i].y,starfield[i].z)
  end
  
  if rx then
    line(rx[1],rx[4],rx[1]+5,rx[4],7)
    line(rx[2],rx[5],rx[2]+5,rx[5],4)
    line(rx[3],rx[6],rx[3]+5,rx[6],3)
  end

  for i = 1, 4 do
    spr(i+2,96,16+16*i)
  end
  
  if bframe then
    rectfill(0,0,128,128,bframe)
    for i = 1, 100 do
      pset(rnd(129),rnd(129),flr(rnd(8)))
    end
  end

	 spr(1,px,py)
	 if bx then
	   spr(17,bx,by)
  end  
  
-- cockpit and stats
  rectfill(0,0,128,12,1)
--  spr(8,8,0)
  print("picostar 0.1",4,4,7)
end
__gfx__
00000000000000000000000022222200000022220002000000222000000000000433333333333333333333200000000000000000000000000000000000000000
00000000333300000000000002333320002233200020000202333000000000000433333333333333333333200000000000000000000000000000000000000000
00700700033333000000000003344332223333320230002023343222000000000433333333333333333333200000000000000000000000000000000000000000
00077000003443300000000023433232033444332332220023443330000000000043333333333333333332000000000000000000000000000000000000000000
00077000002332200000000012122121022333221221110012332220000000000043333333333333333332000000000000000000000000000000000000000000
00700700022222000000000002211221112222210120001012232111000000000004333333333333333320000000000000000000000000000000000000000000
00000000222200000000000001222210001122100010000101222000000000000000223333333333332200000000000000000000000000000000000000000000
00000000000000000000000011111100000011110001000000111000000000000000002222222222220000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000070555700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000055555570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000055555540000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000040555400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000444000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
